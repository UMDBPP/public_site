<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">

    <title>University of Maryland Balloon Payload Program - Predicts</title>
    <link href="../content.css" rel="stylesheet">
    <link href="#" rel="shortcut icon">

    <script crossorigin="anonymous" integrity="sha384-bmPowDlt+owc6Mn3LwOzLPkYiVm6MuKeLMe0qN2pp7Fhmux2xtVJm5e+ekpCVv4x"
            src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
    <link crossorigin="anonymous" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
          integrity="sha384-eS4bw6aEvhCSXWGP85ANR/N8isWKzT7P36NvcuTJGkrj6wsbxLVpXslrNXYHyseD" rel="stylesheet">

    <script crossorigin="anonymous" integrity="sha384-sKs8ZrrxyJoElcPVznZwGpUTTXvkMYfHYxdIFzO8Hd0TA6emONMj8BwnsFf+6cZ/"
            src="https://unpkg.com/leaflet-ajax@2.1.0/dist/leaflet.ajax.min.js"></script>
    <script crossorigin="anonymous" integrity="sha384-MBqvFhoifV/e9S1Ca7DFfXtEHZAYgSiDw5ek8a6BcgVfQdctO9SKp6ueQGC3PSiO"
            src="https://unpkg.com/leaflet-providers@1.8.0/leaflet-providers.js"></script>

    <link href="../scripts/leaflet-groupedlayercontrol/dist/leaflet.groupedlayercontrol.min.css" rel="stylesheet"/>
    <script src="../scripts/leaflet-groupedlayercontrol/dist/leaflet.groupedlayercontrol.min.js"></script>
    <script src="../scripts/mapbox/tokml.js"></script>
    <script src="../scripts/ajax.js"></script>
</head>
<body style="display: flex; flex-direction: column;">
<div style="display: flex; justify-content: space-between; flex-wrap: wrap;">
    <div style="flex-grow: 1;">
        <a href="../">Home</a>
    </div>
    <div style="display: flex; flex-grow: 3; justify-content: space-evenly;">
        <div style="display: flex; flex-wrap: wrap;">
            <input id="launch_date" onchange="updatePredictLayers()" required="required" title="launch date" type="date">

            <input id="launch_time" onchange="updatePredictLayers()" required="required" title="launch time" type="time" value="08:00">
        </div>
        <div>
            <label for="ascent_rate">Ascent Rate (m/s)</label>

            <input id="ascent_rate" onchange="updatePredictLayers()" style="width: 4ch;" title="expected average ascent rate" type="number" value="5.5">
        </div>
        <div>
            <label for="burst_altitude">Burst Altitude (m)</label>

            <input id="burst_altitude" onchange="updatePredictLayers()" style="width: 5ch;" title="expected burst altitude" type="number" value="28000">
        </div>
        <div>
            <label for="sea_level_descent_rate">Descent Rate (m/s)</label>

            <input id="sea_level_descent_rate" onchange="updatePredictLayers()" style="width: 4ch;" title="expected descent rate (at sea level)" type="number" value="9">
        </div>
        <button id="reload_APRS_button" onclick="updatePredictLayers()">Reload</button>
    </div>
    <div style="flex-grow: 1;">
        Resize:
        <button id="resize" onclick="resizeToOverlayLayers()">Extent</button>
    </div>
    <div style="flex-grow: 1;">
        Download:
        <button id="download_predicts" onclick="downloadPredictsKML()">Predicts</button>
        <button id="download_airspace" onclick="downloadURI('../data/controlled_airspace.kmz', 'CONTROLLED_AIRSPACE_LAYER.kmz')">Airspace
        </button>
    </div>
</div>
<div id="map" style="flex-grow: 1;">
    <script src="../scripts/functions.js"></script>
    <script src="../scripts/layers.js"></script>
    <script async src="predicts.js"></script>
    <script async>
        MAP.setView([39.4, -77.4], 10);
        MAP.addLayer(CONTROLLED_AIRSPACE_LAYER);
    </script>
    <script async>
        let today = new Date();
        let next_saturday = new Date();
        next_saturday.setDate(today.getDate() + (7 + 6 - today.getDay()) % 7);
        let prediction_end = new Date();
        prediction_end.setDate(today.getDate() + 8);

        let date_input = document.getElementById('launch_date');
        date_input.value = next_saturday.toISOString().split('T')[0];
        date_input.min = today.toISOString().split('T')[0];
        date_input.max = prediction_end.toISOString().split('T')[0];
    </script>
    <script async type="text/javascript">
        window.onload = function () {
            MAP.on('contextmenu', setCustomLaunchLocation);
            updatePredictLayers();
        };
    </script>
</div>
</body>
</html>
