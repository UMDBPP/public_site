<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <meta content="We are the official high-altitude balloon research program of the A. James Clark School of Engineering at the University of Maryland in College Park, MD."
          name="description">

    <title>University of Maryland Balloon Payload Program</title>
    <link href="content.css" rel="stylesheet">
    <link href="#" rel="shortcut icon">

    <script crossorigin="anonymous"
            integrity="sha384-sbXCuVHmezMFFyUyW5Igyp8ccpu94Snk8Pk+c/aN1Ufe/mAD7EO4017RwfsGIwSV"
            src="https://unpkg.com/chroma-js@2.0.4/chroma.min.js"></script>

    <script crossorigin="anonymous"
            integrity="sha384-bmPowDlt+owc6Mn3LwOzLPkYiVm6MuKeLMe0qN2pp7Fhmux2xtVJm5e+ekpCVv4x"
            src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
    <link crossorigin="anonymous" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
          integrity="sha384-eS4bw6aEvhCSXWGP85ANR/N8isWKzT7P36NvcuTJGkrj6wsbxLVpXslrNXYHyseD" rel="stylesheet">

    <script crossorigin="anonymous"
            integrity="sha384-sKs8ZrrxyJoElcPVznZwGpUTTXvkMYfHYxdIFzO8Hd0TA6emONMj8BwnsFf+6cZ/"
            src="https://unpkg.com/leaflet-ajax@2.1.0/dist/leaflet.ajax.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha384-MBqvFhoifV/e9S1Ca7DFfXtEHZAYgSiDw5ek8a6BcgVfQdctO9SKp6ueQGC3PSiO"
            src="https://unpkg.com/leaflet-providers@1.8.0/leaflet-providers.js"></script>

    <link href="scripts/leaflet-groupedlayercontrol/dist/leaflet.groupedlayercontrol.min.css" rel="stylesheet"/>
    <script src="scripts/leaflet-groupedlayercontrol/dist/leaflet.groupedlayercontrol.min.js"></script>
</head>
<body onresize="resizeBottomPane()">
<div id="top_pane">
    <span class="stretch"></span>
    <div class="top_pane_div">
        <a href="predicts">Predicts</a>
    </div>
    <span class="stretch"></span>
    <!--<div class="top_pane_div">
        <a href="tracking">Tracking</a>
    </div>
    <span class="stretch"></span>-->
    <div class="top_pane_div">
        <a href="/archives">Archives</a>
    </div>
    <span class="stretch"></span>
    <hr>
    <div class="top_pane_div" style="height: 4ch; overflow: auto">
        The <a href="https://md.spacegrant.org/mdsgc-programs/balloon-payload-program"><b>University of Maryland Balloon
        Payload Program</b></a> offers a platform for students to build and send research payloads into the upper
        atmosphere via helium weather balloons.
    </div>
</div>
<div id="bottom_pane">
    <script async src="scripts/resize.js"></script>

    <div id="map">
        <script src="scripts/functions.js"></script>
        <script src="scripts/layers.js"></script>
        <script async>
            MAP.setView([39.7035, -77.3292], 9.5);
            MAP.removeLayer(BASE_LAYERS['Esri Topography']);
            MAP.addLayer(BASE_LAYERS['Esri Gray']);
        </script>
        <script async>
            let COLOR_RAMP = chroma.scale('Viridis').mode('lab');

            let COLOR_VALUE_MIN = dateToTimestamp('2014-11-08');
            let COLOR_VALUE_MAX = dateToTimestamp(new Date().toDateString());

            function spectral_color_ramp(value, min, max) {
                return COLOR_RAMP((value - min) / (max - min));
            }

            function dateToTimestamp(date) {
                return parseInt((new Date(date).getTime() / 1000).toFixed(0));
            }

            let FLIGHTS = L.geoJson.ajax(DATA_DIRECTORY + 'flights.geojson', {
                'onEachFeature': highlightAndPopupOnClick,
                'style': function (feature) {
                    if (feature.feature != null) {
                        feature = feature.feature;
                    }

                    return {
                        'color': spectral_color_ramp(dateToTimestamp(feature.properties['Date']), COLOR_VALUE_MIN, COLOR_VALUE_MAX),
                        'weight': 5
                    };
                }
            });
            MAP.addLayer(FLIGHTS);

            OVERLAY_LAYERS['reference']['McDonald\'s Locations'] = MCDONALDS_LOCATIONS_LAYER;
            OVERLAY_LAYERS['reference']['Launch Locations'] = LAUNCH_LOCATIONS_LAYER;
            OVERLAY_LAYERS['flights'] = {'flights': FLIGHTS};

            MAP.addControl(L.control.groupedLayers(BASE_LAYERS, OVERLAY_LAYERS));
        </script>
    </div>
</div>
</body>
</html>
